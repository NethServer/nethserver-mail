{

if  ( $rspamd{'SpamCheckStatus'} eq 'enabled'){
$OUT .= ' -- symbols/lua rules are not disabled';
}

else {
    # Disable all lua rules
    my $grep = `grep -srni 'rspamd_config\\.' /usr/share/rspamd/rules`;
    $grep =~ s/.*rspamd_config\.//g;
    $grep =~ s/ = \{//g;
    my @grep = split('\n',$grep);
    $OUT .= "-- disable symbol rules\n";
    foreach (@grep) {
        $OUT .= "rspamd_config:add_condition('$_', function(task) return false end)\n";
    }

    # virtual symbol found in /usr/share/rspamd/rules
    $grep = `grep -srni "name = '" /usr/share/rspamd/rules`;
    $grep =~ s/.*name = '//g;
    $grep =~ s/',//g;
    @grep = split('\n',$grep);
    $OUT .= "-- disable virtual symbol \n";
    foreach (@grep) {
        $OUT .= "rspamd_config:add_condition('$_', function(task) return false end)\n";
    }

# we cannot disable globally multimap, we might need it for file type rejection, 
# so we disable symbols
$OUT .= q(

-- multimap static rule 
rspamd_config:add_condition('FREEMAIL_ENVFROM', function(task) return false end)
rspamd_config:add_condition('DISPOSABLE_REPLYTO', function(task) return false end)
rspamd_config:add_condition('FREEMAIL_FROM', function(task) return false end) 
rspamd_config:add_condition('FORBIDDEN_FILE_EXTENSION', function(task) return false end)
rspamd_config:add_condition('DISPOSABLE_CC', function(task) return false end)
rspamd_config:add_condition('DISPOSABLE_TO', function(task) return false end)
rspamd_config:add_condition('DISPOSABLE_FROM', function(task) return false end)
rspamd_config:add_condition('FREEMAIL_TO', function(task) return false end) 
rspamd_config:add_condition('FREEMAIL_ENVRCPT', function(task) return false end)
rspamd_config:add_condition('FREEMAIL_REPLYTO', function(task) return false end)
rspamd_config:add_condition('DISPOSABLE_ENVFROM', function(task) return false end)
rspamd_config:add_condition('FREEMAIL_CC', function(task) return false end)
rspamd_config:add_condition('DISPOSABLE_ENVRCPT', function(task) return false end)

);
}
}
