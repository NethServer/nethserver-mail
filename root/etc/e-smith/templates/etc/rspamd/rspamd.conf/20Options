#
# Options
#
options \{
    pidfile = "$RUNDIR/rspamd.pid";
{
    use esmith::NetworksDB;
    my $ndb = esmith::NetworksDB->open_ro();

    #return a cidr for localnetwork
    foreach (map {
        my ($addr, $mask) = split('/', $_);
        esmith::util::computeLocalNetworkShortSpec($addr, $mask || '255.255.255.255');
             } $ndb->local_access_spec() ) {

        $CIDR .= sprintf("%s, ", $_);
    }

    $OUT = "local_addrs = \"$CIDR ::1\";";
}

filters = "{(($rspamd{'VirusCheckStatus'}||'') eq 'enabled')?'chartable,dkim,spf,surbl,regexp,fuzzy_check':''}";
raw_mode = false;
one_shot = false;
cache_file = "$DBDIR/symbols.cache";
# How often maps are checked (
map_watch_interval = 5min;
# Multiplier for watch interval for files
map_file_watch_multiplier = 0.1;
dynamic_conf = "$DBDIR/rspamd_dynamic";
history_file = "$DBDIR/rspamd.history";
check_all_filters = false;
dns \{
    timeout = 1s;
    sockets = 16;
    retransmits = 5;
\}
tempdir = "/tmp";
url_tld = "$\{PLUGINSDIR\}/effective_tld_names.dat";
classify_headers = [
	"User-Agent",
	"X-Mailer",
	"Content-Type",
	"X-MimeOLE",
];

control_socket = "$DBDIR/rspamd.sock mode=0600";
history_rows = 200;
explicit_modules = ["settings"];

# Scan messages even if they are not MIME
allow_raw_input = true;

# Start ignore words when reaching the following limit, so the total
# amount of words processed will not be *LIKELY more than the twice of that limit
words_decay = 200;

# Write statistics about rspamd usage to the round-robin database
rrd = "${DBDIR}/rspamd.rrd";

# Local networks
hs_cache_dir = "$\{DBDIR\}/";

\}


